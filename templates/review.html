<!DOCTYPE html>
<html lang="en">

<head>
    <title>책 소개</title>
    <!-- for-mobile-apps -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Electronic Store Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, 
	SmartPhone Compatible web template, free web designs for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
    <script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false);
	function hideURLbar(){ window.scrollTo(0,1); } </script>
    <!-- //for-mobile-apps -->
    <!-- Custom Theme files -->
    <link href="static/css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
    <link href="static/css/style.css" rel="stylesheet" type="text/css" media="all" />
    <link href="static/css/fasthover.css" rel="stylesheet" type="text/css" media="all" />
    <!-- //Custom Theme files -->
    <!-- font-awesome icons -->
    <link href="static/css/font-awesome.css" rel="stylesheet">
    <!-- //font-awesome icons -->
    <!-- js -->
    <script src="static/js/jquery.min.js"></script>
    <!-- //js -->
    <!-- web fonts -->
    <link href='//fonts.googleapis.com/css?family=Glegoo:400,700' rel='stylesheet' type='text/css'>
    <link
        href='//fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic,800,800italic'
        rel='stylesheet' type='text/css'>
    <!-- //web fonts -->
    <!-- for bootstrap working -->
    <script type="text/javascript" src="static/js/bootstrap-3.1.1.min.js"></script>
    <!-- //for bootstrap working -->
    <!-- start-smooth-scrolling -->
    <script type="text/javascript">
        $(document).ready(function ($) {
            $(".scroll").click(function (event) {
                event.preventDefault();
                $('html,body').animate({ scrollTop: $(this.hash).offset().top }, 1000);
            });
        });
    </script>
    <!-- //end-smooth-scrolling -->

    <script>
        // function searchParam(review) {
        //     alert(URLSearchParams(location.search).get(review))
        // };


        $(document).ready(function () {
            bookurl = $('#bookreview_url').text();
            emptylist()
            bookinfo(bookurl);
            reviews(bookurl); // 화면 로딩시 리뷰 불러옴
        })

        function emptylist() {
            $('#bookresult').empty();
        }
        function reviews(url) {

            $.ajax({
                type: 'POST',
                url: '/reviews',
                data: {
                    bookurl: url
                },
                success: function (response) {
                    let review = response.review;
                    for (i = 0; i < review.length; i++) {
                        let reviews = response.review[i]
                        make_review(
                            reviews.title,
                            reviews.contents,
                            reviews.location,
                            reviews.reviewer,
                            reviews.review_date
                        )
                    }
                    console.log(review);
                }
            })
        }


        function bookinfo(url) {

            $.ajax({
                type: 'POST',
                url: '/bookinfo',
                data: {
                    bookurl: url
                },
                success: function (response) {
                    let bookinfo = response.info;
                    make_page(
                        bookinfo.title,
                        bookinfo.author,
                        bookinfo.company,
                        bookinfo.date,
                        bookinfo.img
                    )

                }
            })
            return bookinfo.title;
        }

        function make_review(title, contents, location, reviewer, review_date) {

            let reviewlist =
                `<div class="additional_info_sub_grids">
                    <div class="col-xs-2 additional_info_sub_grid_left">
                            <h4>${reviewer}</h4>
                            <h5>${review_date}</h5>
                            <h6>${location}</h6>
                    </div>
                <div class="col-xs-10 additional_info_sub_grid_right">
                <div class="additional_info_sub_grid_rightl">
                    <p>${contents}</p>
                </div>
                <div class="clearfix"> 
                    </div>
                </div>
                <div class="clearfix"> 
                    </div>
                </div>`



            $('#reviews-list').append(reviewlist);
        }

        function make_page(title, author, company, date, img) {
            $("#thumb-image").attr("src", img);
            $("#booktitle").text(title)
            $("#author").text(author)
            $("#company").text(company)
            $("#date").text(date)

        }
        function addShelf(){
            let title = $('#booktitle').text();
            let url = document.location.href;
            $.ajax({
                method: "POST",
                url: "/session_in",
                data: {
                    title:title,
                    url:url
                },
                success: function(response){
                    let event = response.event;
                    console.log(event)
                }
            })
            //window.open('bookshelf')
        }
    </script>
    <style>
        dt {
            float: left;
        }

        dd {
            margin-left: 3px;
        }
        
    </style>
</head>

<body>
    <!-- single -->
    <div class="single">
        <div class="container">
            <!-- 파라미터 받아오기  -->
            <div id="bookreview_url" style="display:none">{{ bookurl }}</div>
            <!--  파라미터 받아오기 끝-->
            <div class="col-md-4 single-left">
                <div class="thumb-image"> <img id="thumb-image" src="" data-imagezoom="true" class="img-responsive"
                        alt=""> </div>
                <!-- zooming-effect -->
                <script src="static/js/imagezoom.js"></script>
                <!-- //zooming-effect -->
            </div>
            <div class="col-md-8 single-right">
                <h3 id='booktitle'></h3>
                <div class="rating1">
                    <span class="starRating">
                        <input id="rating5" type="radio" name="rating" value="5">
                        <label for="rating5">5</label>
                        <input id="rating4" type="radio" name="rating" value="4">
                        <label for="rating4">4</label>
                        <input id="rating3" type="radio" name="rating" value="3" checked>
                        <label for="rating3">3</label>
                        <input id="rating2" type="radio" name="rating" value="2">
                        <label for="rating2">2</label>
                        <input id="rating1" type="radio" name="rating" value="1">
                        <label for="rating1">1</label>
                    </span>
                </div>
                <div class="description">
                    <dl>
                        <dt>저자</dt>
                        <dd id="author"></dd>
                    </dl>
                </div>
                <div class="description">
                    <dl>
                        <dt>출판사</dt>
                        <dd id="company"></dd>
                    </dl>
                </div>
                <div class="description">
                    <dl>
                        <dt>출간일</dt>
                        <dd id="date"></dd>
                    </dl>
                </div>

                <div class="occasional">
                    <div class="colr ert">
                        <div class="check">
                            <h5>내 책상 보유 여부</h5>
                            <label class="checkbox"><input type="checkbox" name="checkbox" checked=""><i> </i>보유</label>
                        </div>
                    </div>

                    <div class="clearfix"> </div>
                </div>
                <div class="simpleCart_shelfItem">
                    <a href='/bookshelf'>
                        <button type="button" class="w3ls-cart" onclick="addShelf()">내 책장에 넣기</button>
                    </a>
                    
            </div>
            <div class="clearfix"> </div>
        </div>
    </div>
    <div class="additional_info">
        <div class="container">
            <div class="sap_tabs">
                <div id="horizontalTab1" style="display: block; width: 100%; margin: 0px;">
                    <ul>
                        <li class="resp-tab-item" aria-controls="tab_item-0" role="tab"><span>책 소개</span>
                        </li>
                        <li class="resp-tab-item" aria-controls="tab_item-1" role="tab"><span>Reviews</span>
                        </li>
                        <li class="resp-tab-item" aria-controls="tab_item-1" role="tab"><span>관련 영상</span>
                        </li>
                    </ul>
                    <div class="tab-1 resp-tab-content additional_info_grid" aria-labelledby="tab_item-0">
                        <p>정세랑의 장편소설 『피프티 피플』. 2016년 1월부터 5월까지 창비 블로그에서 연재되었던 작품으로 수도권의 한 대학병원을 중심으로 느슨하게, 또는 단단하게 연결된
                            50명의 이야기를 담고 있다. 50개의 장으로 구성된 소설 속에서 병원 안팎의 한 사람 한 사람이 처한 곤경과 갑작스럽게 겪게 되는 사고들, 그들이 안고 있는
                            고민들이 흥미진진하면서도 감동적으로 펼쳐진다.

                            의사와 환자로, 환자의 가족으로, 가족의 친구로 긴밀하고 짜임새 있기도 하지만 전혀 관계가 없는 50명의 인물들이 서로를 마주치는 순간의 경이로움을 그려냈다. 꼼꼼한
                            취재와 자문을 통해 의사와 간호사뿐 아니라 보안요원, 이송기사, 임상시험 책임자, 공중보건의 등의 사연과 함께 응급실, 정신과, 외과 등으로 찾아드는 환자들의
                            사연까지 더해 입체적이고 풍성한 이야기를 들려준다.

                            이 작품 속 주인공들이 가진 고민은 현재 사회가 맞닥뜨리고 있는 현안과 멀지 않다. 가습기 살균제 피해자 유가족의 사연, 성소수자의 사연, 층간소음 문제, 낙태와
                            피임에 대한 인식, 씽크홀 추락사고, 대형 화물차 사고 위험 등 2016년의 한국 사회를 생생하게 담아냈고, 특유의 섬세함과 다정함으로 50명의 주인공들의 손을
                            하나하나 맞잡아주며 그들이 겪는 아픔과 고통이 혼자만의 것이 아니며 우리 사회가 같이 이겨내야 한다는 메시지를 전한다.</p>
                    </div>

                    <div class="tab-2 resp-tab-content additional_info_grid" aria-labelledby="tab_item-1">
                        <h4>Reviews</h4>
                        <div id="reviews-list">
                            <!-- reviews 공간 -->
                        </div>
                        <div class="review_grids">
                            <h5>내 리뷰 추가</h5>
                            <form action="#" method="post">
                                <input type="text" name="Name" value="Name" onfocus="this.value = '';"
                                    onblur="if (this.value == '') {this.value = 'Name';}" required="">
                                <input type="email" name="Email" placeholder="Email" required="">
                                <input type="text" name="Telephone" value="Telephone" onfocus="this.value = '';"
                                    onblur="if (this.value == '') {this.value = 'Telephone';}" required="">
                                <textarea name="Review" onfocus="this.value = '';"
                                    onblur="if (this.value == '') {this.value = 'Add Your Review';}"
                                    required="">Add Your Review</textarea>
                                <input type="submit" value="Submit">
                            </form>
                        </div>
                    </div>

                    <!-- <div class="tab-3 resp-tab-content additional_info_grid" aria-labelledby="tab_item-2">
                        <h4>(2) Reviews</h4>
                        <div class="additional_info_sub_grids">
                            <div class="col-xs-2 additional_info_sub_grid_left">
                                <img src="images/t1.png" alt=" " class="img-responsive" />
                            </div>
                            <div class="col-xs-10 additional_info_sub_grid_right">
                                <div class="additional_info_sub_grid_rightl">
                                    <a href="single.html">Laura</a>
                                    <h5>Oct 06, 2016.</h5>
                                    <p>Quis autem vel eum iure reprehenderit qui in ea voluptate
                                        velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat
                                        quo voluptas nulla pariatur.</p>
                                </div>
                                <div class="additional_info_sub_grid_rightr">
                                    <div class="rating">
                                        <div class="rating-left">
                                            <img src="images/star-.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="rating-left">
                                            <img src="images/star-.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="rating-left">
                                            <img src="images/star-.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="rating-left">
                                            <img src="images/star.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="rating-left">
                                            <img src="images/star.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="clearfix"> </div>
                                    </div>
                                </div>
                                <div class="clearfix"> </div>
                            </div>
                            <div class="clearfix"> </div>
                        </div>
                        <div class="additional_info_sub_grids">
                            <div class="col-xs-2 additional_info_sub_grid_left">
                                <img src="images/t2.png" alt=" " class="img-responsive" />
                            </div>
                            <div class="col-xs-10 additional_info_sub_grid_right">
                                <div class="additional_info_sub_grid_rightl">
                                    <a href="single.html">Michael</a>
                                    <h5>Oct 04, 2016.</h5>
                                    <p>Quis autem vel eum iure reprehenderit qui in ea voluptate
                                        velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat
                                        quo voluptas nulla pariatur.</p>
                                </div>
                                <div class="additional_info_sub_grid_rightr">
                                    <div class="rating">
                                        <div class="rating-left">
                                            <img src="images/star-.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="rating-left">
                                            <img src="images/star-.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="rating-left">
                                            <img src="images/star.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="rating-left">
                                            <img src="images/star.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="rating-left">
                                            <img src="images/star.png" alt=" " class="img-responsive">
                                        </div>
                                        <div class="clearfix"> </div>
                                    </div>
                                </div>
                                <div class="clearfix"> </div>
                            </div>
                            <div class="clearfix"> </div>
                        </div>
                        <div class="review_grids">
                            <h5>Add A Review</h5>
                            <form action="#" method="post">
                                <input type="text" name="Name" value="Name" onfocus="this.value = '';"
                                    onblur="if (this.value == '') {this.value = 'Name';}" required="">
                                <input type="email" name="Email" placeholder="Email" required="">
                                <input type="text" name="Telephone" value="Telephone" onfocus="this.value = '';"
                                    onblur="if (this.value == '') {this.value = 'Telephone';}" required="">
                                <textarea name="Review" onfocus="this.value = '';"
                                    onblur="if (this.value == '') {this.value = 'Add Your Review';}"
                                    required="">Add Your Review</textarea>
                                <input type="submit" value="Submit">
                            </form>
                        </div>
                    </div> -->
                </div>
            </div>
            <script src="static/js/easyResponsiveTabs.js" type="text/javascript"></script>
            <script type="text/javascript">
                $(document).ready(function () {
                    $('#horizontalTab1').easyResponsiveTabs({
                        type: 'default', //Types: default, vertical, accordion           
                        width: 'auto', //auto or any width like 600px
                        fit: true   // 100% fit in a container
                    });
                });
            </script>
        </div>
    </div>

    <!-- //single -->

    <!-- cart-js -->
    <script src="static/js/minicart.js"></script>
    <script>
        w3ls.render();

        w3ls.cart.on('w3sb_checkout', function (evt) {
            var items, len, i;

            if (this.subtotal() > 0) {
                items = this.items();

                for (i = 0, len = items.length; i < len; i++) {
                }
            }
        });
    </script>
    <!-- //cart-js -->
</body>

</html>